<!DOCTYPE html>
<html>
	<head>
		<title>Warden</title>
		<meta charset="utf-8" />
		
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="https://warden.corehoundsystem.com/Warden.css">
		<script src='https://code.jquery.com/jquery-1.11.3.min.js'></script>
		<script src='https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js'></script>
		
		<script src="https://warden.corehoundsystem.com/API.js" async></script>
		
		<script src="https://apis.google.com/js/platform.js" defer></script>
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-144497616-1"></script>
		<meta name="google-signin-client_id" content="14788876155-26tavl9ut4bmlncej9ce21a3tstrj1ca.apps.googleusercontent.com">
		
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('set', {'user_id': 'USER_ID'});
			gtag('config', 'UA-144497616-1');
		</script>
		
		<meta name="web_author" content="Core Hound System, LLC">
		<meta http-equiv="window-target" content="_top">
		
	</head>
	<body>
		<div id="tempStuff">
			<p>Google Sheets API Quickstart</p>
			
			
			
			
			
			<button id="authorize_button" style="display: none;">Authorize</button>
			<button id="signout_button" style="display: none;">Sign Out</button>
			
			<pre id="content" style="white-space: pre-wrap;"></pre>
		</div>
		
		<script>
			apis=[
			"gapi.client.people.people.connections.list"
			];
			
			function newFunction() {
				console.log("New funct");
				//listConnectionNames();
				listLabels();
				listUpcomingEvents();
				listMajors();
				thisObject={'resourceName':'people/me','pageSize':10,'personFields':'names,emailAddresses'};
				generalGetter(apis[0],thisObject,connections);
				
				//generalGetter(apis[0]+"("{'resourceName':'people/me','pageSize':10,'personFields':'names,emailAddresses'},connections);
			}
			
			function appendPre(message) {
				var pre = document.getElementById('content');
				var textContent = document.createTextNode(message + '\n');
				pre.appendChild(textContent);
			}
			
			function generalGetter(api,obj,respFunction) {
				//api(obj).then(respFunction(response))
				window[api][obj].then(window[respFunction](response))
			}
			
			function connections(response) {
				console.log(response);
				var connections = response.result.connections;
				appendPre('Connections:');
				if (connections.length > 0) {
					for (i = 0; i < connections.length; i++) {
						var person = connections[i];
						if (person.names && person.names.length > 0) {
							appendPre(person.names[0].displayName)
						} else {
							appendPre("No display name found for connection.");
						}
					}
				} else {
					appendPre('No connections found.');
				}
			}
			
			function listConnectionNames() {
				gapi.client.people.people.connections.list({
					'resourceName': 'people/me',
					'pageSize': 10,
					'personFields': 'names,emailAddresses',
				}).then(function(response) {
					console.log(response);
					var connections = response.result.connections;
					appendPre('Connections:');
					if (connections.length > 0) {
						for (i = 0; i < connections.length; i++) {
							var person = connections[i];
							if (person.names && person.names.length > 0) {
								appendPre(person.names[0].displayName)
							} else {
								appendPre("No display name found for connection.");
							}
						}
					} else {
						appendPre('No connections found.');
					}
				});
			}
			
			function listLabels() {
				gapi.client.gmail.users.labels.list({
					'userId': 'me'
				}).then(function(response) {
					console.log(response);
					var labels = response.result.labels;
					appendPre('Labels:');
					if (labels && labels.length > 0) {
						for (i = 0; i < labels.length; i++) {
							var label = labels[i];
							appendPre(label.name)
						}
					} else {
						appendPre('No Labels found.');
					}
				});
			}
			
			function listUpcomingEvents() {
				gapi.client.calendar.events.list({
					'calendarId': 'primary',
					'timeMin': (new Date()).toISOString(),
					'showDeleted': false,
					'singleEvents': true,
					'maxResults': 10,
					'orderBy': 'startTime'
				}).then(function(response) {
					console.log(response);
					var events = response.result.items;
					appendPre('Upcoming events:');
					if (events.length > 0) {
						for (i = 0; i < events.length; i++) {
							var event = events[i];
							var when = event.start.dateTime;
							if (!when) {
								when = event.start.date;
							}
							appendPre(event.summary + ' (' + when + ')')
						}
					} else {
						appendPre('No upcoming events found.');
					}
				});
			}
			
			function listMajors() {
				gapi.client.sheets.spreadsheets.values.get({
					spreadsheetId: '1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms',
					range: 'Class Data!A2:E',
				}).then(function(response) {
					console.log(response);
					var range = response.result;
					if (range.values.length > 0) {
						appendPre('Name, Major:');
						for (i = 0; i < range.values.length; i++) {
							var row = range.values[i];
							appendPre(row[0] + ', ' + row[4]);
						}
					} else {
						appendPre('No data found.');
					}
				}, function(response) {
					appendPre('Error: ' + response.result.error.message);
				});
			}
			
		</script>
		
		<script async defer src="https://apis.google.com/js/api.js"
			onload="this.onload=function(){};handleClientLoad();"
			onreadystatechange="if (this.readyState === 'complete') this.onload()">
		</script>
	</body>
</html>
